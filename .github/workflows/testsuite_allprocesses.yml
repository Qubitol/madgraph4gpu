# Copyright (C) 2020-2023 CERN and UCLouvain.
# Licensed under the GNU Lesser General Public License (version 3 or later).
# Created by: A. Valassi (Nov 2023) for the MG5aMC CUDACPP plugin.
# Further modified by: A. Valassi (2023) for the MG5aMC CUDACPP plugin.

#----------------------------------------------------------------------------------------------------------------------------------

name: Test all processes

#----------------------------------------------------------------------------------------------------------------------------------

on:

  # Enable the possibility to manually trigger the all-processes workflow
  workflow_dispatch:

  # Trigger the all-processes workflow for pull requests to master
  pull_request:
    branches: [ master ]

  # Trigger the all-processes workflow when new changes to the workflow are pushed
  push:
    paths: [ .github/workflows/testsuite* ]

#----------------------------------------------------------------------------------------------------------------------------------

jobs:

  # See https://stackoverflow.com/a/75337311
  oneprocess:
    strategy:
      fail-fast: false # important to see all results even if one fails (fail-fast is true by default)
      matrix:
        # FIXME? Can the list of supported processes be specified only once in oneprocess.yml or allprocesses.yml?
        process: [ee_mumu, gg_tt, gg_ttg, gg_ttgg, gg_ttggg, gg_tt01g, gq_ttq, pp_tt012j]
        ###process: [ee_mumu, gg_tt, gg_ttg, gg_ttgg, gq_ttq]
        suffix: [mad, sa]
    uses: ./.github/workflows/testsuite_oneprocess.yml
    with:
      process: ${{ matrix.process }}.${{ matrix.suffix }}
      # By default, in allprocesses tests enable FPE tests when pushing, but not in pull requests
      enableFPE: ${{ github.event_name != 'pull_request' }}

#----------------------------------------------------------------------------------------------------------------------------------
