# Kokkos code generation for Madgraph5

this directory contains the MG5 Plugin for generating kokkos code in `CODEGEN` and example autogenerated codes for the processes
- `e+ e- > mu+ mu-`,
- `g g > t t~`, and
- `g g > t t~ g g`.

Kokkos (`g g > t t~ g g`)
AMD EPYC 7532 32-Core Processor
NVIDIA-SMI 470.57.02    Driver Version: 470.57.02    CUDA Version: cuda_11.4.3_470.82.01_linux NVIDIA A100-PCIE-40GB

```bash
*******************************************************************************
Process                     = SIGMA_SM_GG_TTXGG_CUDA [nvcc 11.4.152 (gcc 9.2.0)] [inlineHel=0]
NumBlocksPerGrid            = 1000
NumThreadsPerBlock          = 256
NumIterations               = 10
IsGoodHel                   = 64 out of 64
-------------------------------------------------------------------------------
FP precision                = DOUBLE (NaN/abnormal=0, zero=0)
Complex type                = THRUST::COMPLEX
RanNumb memory layout       = AOSOA[8] [HARDCODED FOR REPRODUCIBILITY]
Momenta memory layout       = AOSOA[4]
Random number generation    = CURAND DEVICE (CUDA code)
-------------------------------------------------------------------------------
NumberOfEntries             = 10
TotalTime[Rnd+Rmb+ME] (123) = ( 4.599300e+00                 )  sec
TotalTime[Rambo+ME]    (23) = ( 4.596377e+00                 )  sec
TotalTime[RndNumGen]    (1) = ( 2.923471e-03                 )  sec
TotalTime[Rambo]        (2) = ( 1.086633e-02                 )  sec
TotalTime[MatrixElems]  (3) = ( 4.585510e+00                 )  sec
MeanTimeInMatrixElems       = ( 4.585510e-01                 )  sec
[Min,Max]TimeInMatrixElems  = [ 4.510224e-01 ,  4.628356e-01 ]  sec
TotalTime[MECalcOnly]  (3a) = ( 4.585475e+00                 )  sec
MeanTimeInMECalcOnly        = ( 4.585475e-01                 )  sec
[Min,Max]TimeInMECalcOnly   = [ 4.510193e-01 ,  4.628322e-01 ]  sec
-------------------------------------------------------------------------------
TotalEventsComputed         = 2560000
EvtsPerSec[Rnd+Rmb+ME](123) = ( 5.566064e+05                 )  sec^-1
EvtsPerSec[Rmb+ME]     (23) = ( 5.569605e+05                 )  sec^-1
EvtsPerSec[MatrixElems] (3) = ( 5.582803e+05                 )  sec^-1
EvtsPerSec[MECalcOnly] (3a) = ( 5.582846e+05                 )  sec^-1
*******************************************************************************
NumMatrixElems(notAbnormal) = 2560000
MeanMatrixElemValue         = ( 1.399392e+02 +- 1.045173e+02 )  GeV^-4
[Min,Max]MatrixElemValue    = [ 1.135926e-08 ,  2.487193e+08 ]  GeV^-4
StdDevMatrixElemValue       = ( 1.672277e+05                 )  GeV^-4
MeanWeight                  = ( 2.812272e+01 +- 0.000000e+00 )
[Min,Max]Weight             = [ 2.812272e+01 ,  2.812272e+01 ]
StdDevWeight                = ( 0.000000e+00                 )
*******************************************************************************
00 CudaFree :     0.000007 sec
0a ProcInit :     0.003834 sec
0b MemAlloc :     0.000419 sec
0c GenCreat :     0.002998 sec
0d SGoodHel :     0.462103 sec
1a GenSeed  :     0.000002 sec
1b GenRnGen :     0.002923 sec
2a RamboIni :     0.001235 sec
2b RamboFin :     0.009593 sec
2c CpDTHwgt :     0.000020 sec
2d CpDTHmom :     0.000018 sec
3a SigmaKin :     4.585475 sec
3b CpDTHmes :     0.000035 sec
4a DumpLoop :     0.011576 sec
8a CompStat :     0.017807 sec
9a GenDestr :     0.000003 sec
9b DumpScrn :     0.000158 sec
9c DumpJson :     0.000001 sec
TOTAL       :     5.098208 sec
TOTAL (123) :     4.599302 sec
TOTAL  (23) :     4.596376 sec
TOTAL   (1) :     0.002926 sec
TOTAL   (2) :     0.010866 sec
TOTAL   (3) :     4.585510 sec
TOTAL  (3a) :     4.585475 sec
*******************************************************************************
```


CUDA (`g g > t t~ g g`)
AMD EPYC 7532 32-Core Processor
NVIDIA-SMI 470.57.02    Driver Version: 470.57.02    CUDA Version: cuda_11.4.3_470.82.01_linux NVIDIA A100-PCIE-40GB

```bash
*******************************************************************************
Process                     = SIGMA_SM_GG_TTXGG_CUDA [nvcc 11.4.152 (gcc 9.2.0)] [inlineHel=0]
NumBlocksPerGrid            = 1000
NumThreadsPerBlock          = 256
NumIterations               = 10
IsGoodHel                   = 64 out of 64
-------------------------------------------------------------------------------
FP precision                = DOUBLE (NaN/abnormal=0, zero=0)
Complex type                = THRUST::COMPLEX
RanNumb memory layout       = AOSOA[8] [HARDCODED FOR REPRODUCIBILITY]
Momenta memory layout       = AOSOA[4]
Random number generation    = CURAND DEVICE (CUDA code)
-------------------------------------------------------------------------------
NumberOfEntries             = 10
TotalTime[Rnd+Rmb+ME] (123) = ( 4.301001e+00                 )  sec
TotalTime[Rambo+ME]    (23) = ( 4.298308e+00                 )  sec
TotalTime[RndNumGen]    (1) = ( 2.693269e-03                 )  sec
TotalTime[Rambo]        (2) = ( 3.610351e-02                 )  sec
TotalTime[MatrixElems]  (3) = ( 4.262204e+00                 )  sec
MeanTimeInMatrixElems       = ( 4.262204e-01                 )  sec
[Min,Max]TimeInMatrixElems  = [ 4.252551e-01 ,  4.270057e-01 ]  sec
TotalTime[MECalcOnly]  (3a) = ( 4.260730e+00                 )  sec
MeanTimeInMECalcOnly        = ( 4.260730e-01                 )  sec
[Min,Max]TimeInMECalcOnly   = [ 4.251080e-01 ,  4.268558e-01 ]  sec
-------------------------------------------------------------------------------
TotalEventsComputed         = 2560000
EvtsPerSec[Rnd+Rmb+ME](123) = ( 5.952103e+05                 )  sec^-1
EvtsPerSec[Rmb+ME]     (23) = ( 5.955832e+05                 )  sec^-1
EvtsPerSec[MatrixElems] (3) = ( 6.006282e+05                 )  sec^-1
EvtsPerSec[MECalcOnly] (3a) = ( 6.008360e+05                 )  sec^-1
*******************************************************************************
NumMatrixElems(notAbnormal) = 2560000
MeanMatrixElemValue         = ( 1.669103e+01 +- 8.352812e+00 )  GeV^-4
[Min,Max]MatrixElemValue    = [ 1.146325e-08 ,  1.901587e+07 ]  GeV^-4
StdDevMatrixElemValue       = ( 1.336450e+04                 )  GeV^-4
MeanWeight                  = ( 2.812272e+01 +- 0.000000e+00 )
[Min,Max]Weight             = [ 2.812272e+01 ,  2.812272e+01 ]
StdDevWeight                = ( 0.000000e+00                 )
*******************************************************************************
00 CudaFree :     6.575045 sec
0a ProcInit :     0.000960 sec
0b MemAlloc :     0.021438 sec
0c GenCreat :     0.373873 sec
0d SGoodHel :     0.425839 sec
1a GenSeed  :     0.000005 sec
1b GenRnGen :     0.002688 sec
2a RamboIni :     0.000051 sec
2b RamboFin :     0.000032 sec
2c CpDTHwgt :     0.003515 sec
2d CpDTHmom :     0.032507 sec
3a SigmaKin :     4.260730 sec
3b CpDTHmes :     0.001474 sec
4a DumpLoop :     0.004809 sec
8a CompStat :     0.012638 sec
9a GenDestr :     0.000403 sec
9b DumpScrn :     0.000204 sec
9c DumpJson :     0.000001 sec
TOTAL       :    11.716212 sec
TOTAL (123) :     4.301002 sec
TOTAL  (23) :     4.298308 sec
TOTAL   (1) :     0.002693 sec
TOTAL   (2) :     0.036104 sec
TOTAL   (3) :     4.262205 sec
TOTAL  (3a) :     4.260730 sec
*******************************************************************************
```